<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>con-gen-csu - 12&nbsp; Snakemake-relevant Python for R Users</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../nmfs-bioinf/snakemake-embellishments.html" rel="next">
<link href="../nmfs-bioinf/snake.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../nmfs-bioinf/snakemake-relevant-python.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Snakemake-relevant Python for R Users</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../nmfs-bioinf/quarto-static/fisheries_header_logo_jul2019.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">con-gen-csu</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/eriqande/con-gen-csu" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/open-on-demand-alpine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">OpenOnDemand on Alpine</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/quick-unix-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Quick Unix Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/shell-prog.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Shell Programming</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/awk-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">A Brief <code>awk</code> Intro</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/scripts-and-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Bash scripts and functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/slurm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sedna and SLURM intro</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/sbatch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Submitting jobs with <code>sbatch</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/slurm-arrays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Slurm Job Arrays</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/sequence-alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Sequence alignment and handling BAM files</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/bioinf-formats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Bioinformatic file formats</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/snake.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Snakemake Narrative and Topics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/snakemake-relevant-python.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Snakemake-relevant Python for R Users</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nmfs-bioinf/snakemake-embellishments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Important Snakemake Embellishments</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#running-python-interactively-in-rstudio" id="toc-running-python-interactively-in-rstudio" class="nav-link active" data-scroll-target="#running-python-interactively-in-rstudio"><span class="header-section-number">12.1</span> Running python, interactively, in RStudio</a>
  <ul class="collapse">
  <li><a href="#get-mamba-and-create-a-snakemake-environment" id="toc-get-mamba-and-create-a-snakemake-environment" class="nav-link" data-scroll-target="#get-mamba-and-create-a-snakemake-environment"><span class="header-section-number">12.1.1</span> Get mamba and create a snakemake environment</a></li>
  <li><a href="#get-the-reticulate-package-and-run-python-from-your-snakemake-conda-environment" id="toc-get-the-reticulate-package-and-run-python-from-your-snakemake-conda-environment" class="nav-link" data-scroll-target="#get-the-reticulate-package-and-run-python-from-your-snakemake-conda-environment"><span class="header-section-number">12.1.2</span> Get the reticulate package and run python from your snakemake conda environment</a></li>
  </ul></li>
  <li><a href="#r-and-python-compare-and-contrast" id="toc-r-and-python-compare-and-contrast" class="nav-link" data-scroll-target="#r-and-python-compare-and-contrast"><span class="header-section-number">12.2</span> R and Python: compare and contrast</a>
  <ul class="collapse">
  <li><a href="#python-doesnt-have-native-vectors" id="toc-python-doesnt-have-native-vectors" class="nav-link" data-scroll-target="#python-doesnt-have-native-vectors"><span class="header-section-number">12.2.1</span> Python doesn’t have native vectors</a></li>
  <li><a href="#pythons-native-array-is-like-an-r-list-without-any-names" id="toc-pythons-native-array-is-like-an-r-list-without-any-names" class="nav-link" data-scroll-target="#pythons-native-array-is-like-an-r-list-without-any-names"><span class="header-section-number">12.2.2</span> Python’s native array is like an R list (without any names)</a></li>
  <li><a href="#double-or-single-quotes-in-python" id="toc-double-or-single-quotes-in-python" class="nav-link" data-scroll-target="#double-or-single-quotes-in-python"><span class="header-section-number">12.2.3</span> Double or single quotes in Python?</a></li>
  <li><a href="#replacement-of-elements-of-a-list" id="toc-replacement-of-elements-of-a-list" class="nav-link" data-scroll-target="#replacement-of-elements-of-a-list"><span class="header-section-number">12.2.4</span> Replacement of elements of a list</a></li>
  <li><a href="#operating-on-every-element-of-a-list" id="toc-operating-on-every-element-of-a-list" class="nav-link" data-scroll-target="#operating-on-every-element-of-a-list"><span class="header-section-number">12.2.5</span> Operating on every element of a list</a></li>
  <li><a href="#type-conversion-is-not-automatic-in-python" id="toc-type-conversion-is-not-automatic-in-python" class="nav-link" data-scroll-target="#type-conversion-is-not-automatic-in-python"><span class="header-section-number">12.2.6</span> Type conversion is not automatic in Python</a></li>
  <li><a href="#list-comprehension-operating-on-every-element-of-a-list-part-2" id="toc-list-comprehension-operating-on-every-element-of-a-list-part-2" class="nav-link" data-scroll-target="#list-comprehension-operating-on-every-element-of-a-list-part-2"><span class="header-section-number">12.2.7</span> List comprehension: Operating on every element of a list, Part 2</a></li>
  <li><a href="#for-lists-in-python-is-like-cit-catenates-the-lists" id="toc-for-lists-in-python-is-like-cit-catenates-the-lists" class="nav-link" data-scroll-target="#for-lists-in-python-is-like-cit-catenates-the-lists"><span class="header-section-number">12.2.8</span> For lists, <code>+</code> in python is like <code>c()</code>—it catenates the lists</a></li>
  <li><a href="#sec-dict" id="toc-sec-dict" class="nav-link" data-scroll-target="#sec-dict"><span class="header-section-number">12.2.9</span> Named lists in R and <code>dict</code>s in python</a></li>
  <li><a href="#classes-and-objects" id="toc-classes-and-objects" class="nav-link" data-scroll-target="#classes-and-objects"><span class="header-section-number">12.2.10</span> Classes and objects</a></li>
  <li><a href="#defining-functions" id="toc-defining-functions" class="nav-link" data-scroll-target="#defining-functions"><span class="header-section-number">12.2.11</span> Defining functions</a></li>
  <li><a href="#r-packages-and-python-modules" id="toc-r-packages-and-python-modules" class="nav-link" data-scroll-target="#r-packages-and-python-modules"><span class="header-section-number">12.2.12</span> R packages and python modules</a></li>
  <li><a href="#tabular-data-pandas-in-python-is-sort-of-like-dplyr-in-r" id="toc-tabular-data-pandas-in-python-is-sort-of-like-dplyr-in-r" class="nav-link" data-scroll-target="#tabular-data-pandas-in-python-is-sort-of-like-dplyr-in-r"><span class="header-section-number">12.2.13</span> Tabular data: pandas in python is sort of like dplyr in R</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/eriqande/con-gen-csu/edit/main/nmfs-bioinf/snakemake-relevant-python.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/eriqande/con-gen-csu/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Snakemake-relevant Python for R Users</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Snakefiles are YAML formatted files which are interpreted by Python, and, as such, considerable value can be gained from knowing how to use Python in this context. Many biologists I know are quite familiar with R, but fewer are equally well-versed in Python. So the purpose of this chapter is to provide a little background on Python (from the eyes of an R user) that is most useful for embellishing one’s Snakefiles and workflows. The key goal for this chapter is to introduce several simple Python constructs that can be particularly useful in Snakemake, allowing the user to competently use several central Snakemake features: <em>config files</em>, <em>input functions</em>, and <em>pandas input</em>.</p>
<p>The second main goal of this chapter is to illustrate an approach to working interactively with Python (the way R users might be familiar with working with R) within the RStudio environment. As we will see in the next chapter, this will allow users to run Python code associated with their Snakefile in the context of an interactive Python session, which can be considerably more illuminating—and more helpful for tracking down bugs/errors/inconsistencies—than only getting to run that code by running Snakemake on your Snakefile. Being able to work interactively with the Python code as Snakemake might see it is very helpful for learning how to write workflows. The next chapter has most of the gory details for this second goal, like some little hacks for seeing input function parameters as Snakemake might see them, etc., primarily as a learning tool to aid in figuring out how to write Python code within Snakemake. In this chapter we talk about how to set up RStudio to work interactively in the python environment that snakemake uses.</p>
<p>The order of events here is thus:</p>
<ol type="1">
<li><p>Use the R package ‘reticulate’ to run python, interactively, in our Snakemake conda environment.</p></li>
<li><p>Once we can work interactively in python easily, we will discuss a few of the main data structures and operations in python by comparing to their equivalents in R and the tidyverse, talk about defining functions, and take a brief tour of python’s ‘pandas’ package, which is similar in its functionality to R’s tidyverse.</p></li>
<li><p>With that background we will tackle our exploration of Snakemake’s use of</p></li>
</ol>
<ul>
<li>YAML-based configuration files (i.e., config.yaml)</li>
<li>Input functions for converting wildcard values to specialized input paths or parameter values.</li>
<li>pandas for the inclusion of tabular information into the Snakemake workflow, itself.</li>
</ul>
<section id="running-python-interactively-in-rstudio" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="running-python-interactively-in-rstudio"><span class="header-section-number">12.1</span> Running python, interactively, in RStudio</h2>
<p>The folks at Posit (the company that started as RStudio) make a great integrated development environment (IDE) for working with R; however they also recognized the need for being a great IDE for other languages, like python and julia. As I understand it, that was part of the reason that they changed their name to Posit—to be less tied to the R language. At any rate, they have tools for running python code, much like you would run R code in RStudio.</p>
<section id="get-mamba-and-create-a-snakemake-environment" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="get-mamba-and-create-a-snakemake-environment"><span class="header-section-number">12.1.1</span> Get mamba and create a snakemake environment</h3>
<p>You can do this on your laptop, rather than upon the cluster; however, if you have been working on Alpine, you should skip the rest of this section and get an RStudio session on Alpine following the directions in <a href="open-on-demand-alpine.html" class="quarto-xref"><span>Chapter 1</span></a>. Returning to here to get the reticulate package and proceed.</p>
<p>If you are doing this on your laptop, fortunately, mamba works on all platforms, and so does Snakemake. But you might need to first install mamba on your laptop. This is pretty straightforward. If you do not already have mamba on your laptop, find the instructions for your platform <a href="https://github.com/conda-forge/miniforge?tab=readme-ov-file#install">here</a> and follow them. You should be able to just use the default location for your conda/mamba library.</p>
<p>Once you are done with that, you will want to create a snakemake environment on your laptop. Do that by following the directions that we used on our clusters, <a href="https://eriqande.github.io/con-gen-csu/snake-slides.html#/setting-up-our-workspaces">here</a>, without bothering to be on a compute node, of course, since you are on your laptop!</p>
<p>When both of the above are done, we can move on to working with python in RStudio.</p>
</section>
<section id="get-the-reticulate-package-and-run-python-from-your-snakemake-conda-environment" class="level3" data-number="12.1.2">
<h3 data-number="12.1.2" class="anchored" data-anchor-id="get-the-reticulate-package-and-run-python-from-your-snakemake-conda-environment"><span class="header-section-number">12.1.2</span> Get the reticulate package and run python from your snakemake conda environment</h3>
<p>The reticulate package allows you to run python in a comfortable, interactive way within an R (and RStudio) session. Importantly, it allows you to run the exact python version that Snakemake uses by letting you load the snakemake conda environment.</p>
<p>So, Sync your fork, then open up the RStudio project for your fork of the <code>con-gen-csu</code> repo, make sure you are on the main branch, and then pull, to make sure that you have all the recent materials from the course.</p>
<p>If you do not already have the ‘reticulate’, R-package, get it with this command at the R console in Rstudio. If you are Alpine you must do this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first do this</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"reticulate"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># then do this:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"reticulate"</span>, <span class="at">repos =</span> <span class="st">"https://cran.rstudio.com/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that, on Alpine, it is critical to use that second line where you add the <code>repos = "https://cran.rstudio.com/</code> part in there. The RStudio Server maintained by CURC in OpenOnDemand is configured by default to draw its packages from a repository full of binary versions, and it may end up givng you versions of packages which are much older than the most recent versions. (At the time of this writing, it installed ‘reticulate’ version 1.28 instead of 1.35, and all the following steps failed…I lost a good several hours because of that!!) We do the initial <code>install.packages("reticulate")</code> to install binary versions of some of the dependencies for the ‘reticulate’ package.</p>
<p>If you are not on Alpine, you should be able to simply do:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"reticulate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>to get the latest version of reticulate.</p>
<p>Then, you can load the package with:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, we want to use python from a particular conda environment—our snakemake conda environment, in fact. For that there is a reticulate function called <code>use_condaenv()</code>. We can tell it which conda environment to use most reliably by passing the absolute path of the environment to the function. This path will be the path to your conda library plus <code>envs</code> plus the name of the environment. For example on my laptop that would translate into:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_condaenv</span>(<span class="at">condaenv =</span> <span class="st">"~/mambaforge-arm64/envs/snakemake-8.5.3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>However, if you are on Alpine, your conda library would probably be in <code>/project/user@colostate.edu/miniforge</code>.</p>
<p>While on my RStudio Server session on Alpine I would do:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_condaenv</span>(<span class="at">condaenv =</span> <span class="st">"/projects/eriq@colostate.edu/miniforge3/envs/snakemake-8.5.3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>At any rate, it should be easy to find the path to your snakemake environment using tab-completion for path names in your R console.</p>
<p>Once you have successfully given the above command, you can start a python REPL (Read Evaluate Print and Loop) session in your R console with:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">repl_python</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After you have done that, you should see something that looks like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">repl_python</span>()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Python <span class="dv">3</span>.<span class="fl">12.2</span> (<span class="sc">/</span>Users<span class="sc">/</span>eriq<span class="sc">/</span>mambaforge<span class="sc">-</span>arm64<span class="sc">/</span>envs<span class="sc">/</span>snakemake<span class="dv">-8</span>.<span class="fl">5.3</span><span class="sc">/</span>bin<span class="sc">/</span>python)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Reticulate <span class="dv">1</span>.<span class="fl">35.0</span> REPL <span class="sc">--</span> A Python interpreter <span class="cf">in</span> R.</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Enter <span class="st">'exit'</span> or <span class="st">'quit'</span> to exit the REPL and return to R.</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The command prompt has now changed to <code>&gt;&gt;&gt;</code> and anything you type at it will be interpreted as python code.</p>
<p>So, you can’t just type R code into it any longer. For example, see what happens if you type this in there:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>But you can type python code, for example:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then try:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note, to get out of the python REPL loop, you can type:</p>
<pre><code>exit</code></pre>
<p>which will drop you back into R.</p>
</section>
</section>
<section id="r-and-python-compare-and-contrast" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="r-and-python-compare-and-contrast"><span class="header-section-number">12.2</span> R and Python: compare and contrast</h2>
<p>You can consider this a sort of Berlitz language course for R-speakers on how to communicate in Python. It assumes that y’all know something about R. This is really just scratching the surface of both langauges, but it will supply you with a few important things for working in Snakemake.</p>
<section id="python-doesnt-have-native-vectors" class="level3" data-number="12.2.1">
<h3 data-number="12.2.1" class="anchored" data-anchor-id="python-doesnt-have-native-vectors"><span class="header-section-number">12.2.1</span> Python doesn’t have native vectors</h3>
<p>In R, we are all familiar with vectors. Each element of a vector is of the same <em>type</em>, i.e., integer, numeric, or character/string, etc. Here we make a numeric vector and a character vector in R:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># numeric vector</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># character vector</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>One nice feature of having vectors is that we can do array processing of them—i.e., many operations/functions in R are <em>vectorized</em>: they do the same thing to each element of the vector. For example:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   1   4   9  16  25  36  49  64  81 100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(y, <span class="st">"!"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a!" "b!" "c!"</code></pre>
</div>
</div>
<p>By contrast, vectors and vectorized operations, as such, <em>do not</em> exist natively in Python. Some packages provide that type of functionality, but it is not “baked into the guts of the language” the way it is in R.</p>
</section>
<section id="pythons-native-array-is-like-an-r-list-without-any-names" class="level3" data-number="12.2.2">
<h3 data-number="12.2.2" class="anchored" data-anchor-id="pythons-native-array-is-like-an-r-list-without-any-names"><span class="header-section-number">12.2.2</span> Python’s native array is like an R list (without any names)</h3>
<p>Though python does not have a native vector class, like R’s, it does have something that is very similar to an R list, and, in fact, in python these are called “lists.”</p>
<p>In R you make a list, which is a special type of vector that can include elements of different types (i.e., one element could be an integer, another a character/string, another a numeric vector, and another a list!, etc.), like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>L_R <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"R"</span>, <span class="st">"word"</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>and you could find its length with:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(L_R)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p>The equivalent data structure in Python is a list and it is formed with <code>[ ]</code>:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>L_Py <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"R"</span>, <span class="st">"word"</span>, <span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>and you can get its length with:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(L_Py)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>5</code></pre>
</div>
</div>
<p>You can access the elements of an R list using the <code>[[ ]]</code> operator and the index of each element. In R, lists are “base-1 indexed,” which means the first element has the index 1, and the second the index 2, and so forth. For example:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the first element of the R list L_R</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>L_R[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the fourth element of the R list L_R</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>L_R[[<span class="dv">4</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "word"</code></pre>
</div>
</div>
<p>To access elements of a python list you use <code>[ ]</code>, but <strong>(THIS IS EXTREMELY IMPORTANT!)</strong> python lists are “base-0 indexed”— the indexes of a python list start from 0, instead of 1. So, if you want the <strong>first</strong> element of a python list, you subscript it with 0:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>L_Py[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1</code></pre>
</div>
</div>
<p>While, if you wanted the 4-th element of a python list you would subscript it with 3:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>L_Py[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>'word'</code></pre>
</div>
</div>
</section>
<section id="double-or-single-quotes-in-python" class="level3" data-number="12.2.3">
<h3 data-number="12.2.3" class="anchored" data-anchor-id="double-or-single-quotes-in-python"><span class="header-section-number">12.2.3</span> Double or single quotes in Python?</h3>
<p>We also note in the above output that python seems to have a preference for using single quotes for strings in its output; however just as in R, you can use <code>"</code> and <code>'</code> somewhat interchangeably in Python. According to <a href="https://stackoverflow.com/questions/65758620/are-there-any-differences-in-and-in-python">StackOverflow</a>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>In Python there <span class="kw">is</span> no difference between both quotations of a string.</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>As you have noticed both result <span class="kw">in</span> the same value stored <span class="kw">in</span> a variable.</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>There <span class="kw">is</span> an important advantage of being able to use these quotation marks</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>interchangeably <span class="op">-</span> you can include <span class="kw">in</span> the string the quotation mark that you</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>are <span class="kw">not</span> using to enquote the string, e.g.:</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>single <span class="op">=</span> <span class="st">"This string variable contains 'single' quotation marks."</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>double <span class="op">=</span> <span class="st">'This string variable contains "double" quotation marks.'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>So, that is sort of like R, though R makes internal substitutions and some backslash-escaping of double quotes. Here is the R version:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>heck_double <span class="ot">&lt;-</span> <span class="st">"What the 'heck'?"</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>heck_single <span class="ot">&lt;-</span> <span class="st">'What the "heck"?'</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>heck_double</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "What the 'heck'?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>heck_single</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "What the \"heck\"?"</code></pre>
</div>
</div>
<p>Here is the Python version:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># python</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>heck_double <span class="op">=</span> <span class="st">"What the 'heck'?"</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>heck_single <span class="op">=</span> <span class="st">'What the "heck"?'</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>heck_double</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>"What the 'heck'?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>heck_single</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'What the "heck"?'</code></pre>
</div>
</div>
<p>That said, every Snakefile I have seen out in the wild tends to use double quotes to enquote path names and simple command lines.</p>
</section>
<section id="replacement-of-elements-of-a-list" class="level3" data-number="12.2.4">
<h3 data-number="12.2.4" class="anchored" data-anchor-id="replacement-of-elements-of-a-list"><span class="header-section-number">12.2.4</span> Replacement of elements of a list</h3>
<p>In R, you know that you can change one element of a list with a simple assignment to that element:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>L_R[[<span class="dv">5</span>]] <span class="ot">&lt;-</span> <span class="st">"New Last Element"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># now we print the whole list</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>L_R</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1

[[2]]
[1] 2

[[3]]
[1] "R"

[[4]]
[1] "word"

[[5]]
[1] "New Last Element"</code></pre>
</div>
</div>
<p>In python we can do exactly the same thing:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>L_Py[<span class="dv">4</span>] <span class="op">=</span> <span class="st">"New Last Element"</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># now print the whole python list</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>L_Py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 'R', 'word', 'New Last Element']</code></pre>
</div>
</div>
</section>
<section id="operating-on-every-element-of-a-list" class="level3" data-number="12.2.5">
<h3 data-number="12.2.5" class="anchored" data-anchor-id="operating-on-every-element-of-a-list"><span class="header-section-number">12.2.5</span> Operating on every element of a list</h3>
<p>Since vectorized operations do not occur automatically over the elements of lists in R, you may be familiar with the <code>lapply()</code> function in R, which applies a function to every element of a list. So, if we wanted to append “Weird!” to every element of list <code>L_R</code>, we could do something like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(L_R, <span class="cf">function</span>(x) <span class="fu">paste</span>(x, <span class="st">"Weird!"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "1 Weird!"

[[2]]
[1] "2 Weird!"

[[3]]
[1] "R Weird!"

[[4]]
[1] "word Weird!"

[[5]]
[1] "New Last Element Weird!"</code></pre>
</div>
</div>
<p>Here, we have, on the fly, defined a new function using the <code>function()</code> function in R. This is called an “anonymous” function because we do not give it a name, but it returns a function in the context where R is expecting a function (i.e., the <code>FUN</code> argument of <code>lapply()</code>). We see above that <code>lapply()</code> returns a list.</p>
<p>In python, there is a function very similar to <code>lapply()</code> in R, and it is called <code>map</code>. Additionally, there is a notion of an “anonymous” function, but, in python, these are called “lambda” functions. The analogous syntax in python for appending “Weird!” to each element of a list would be:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x) <span class="op">+</span> <span class="st">" Weird!"</span>, L_Py)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;map object at 0x1095375b0&gt;</code></pre>
</div>
</div>
<p><code>map</code> is like <code>lapply()</code> but the order of its arguments is reversed—it takes the function first and the list second—and it doesn’t automatically return a list; rather, as you can see, it returns a <code>&lt;map object at some_location&gt;</code> where some <code>some_location</code> is the address of some computer memory, like <code>0x292826170</code>.</p>
<p>If you want to get the actual list back from <code>map(lambda x: str(x) + " Weird!", L_Py)</code> you have to pass it into python’s <code>list()</code> function:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x) <span class="op">+</span> <span class="st">' Weird!'</span>, L_Py))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['1 Weird!', '2 Weird!', 'R Weird!', 'word Weird!', 'New Last Element Weird!']</code></pre>
</div>
</div>
</section>
<section id="type-conversion-is-not-automatic-in-python" class="level3" data-number="12.2.6">
<h3 data-number="12.2.6" class="anchored" data-anchor-id="type-conversion-is-not-automatic-in-python"><span class="header-section-number">12.2.6</span> Type conversion is not automatic in Python</h3>
<p>In R, some type conversion is automatic if it goes from a more restricted to a more general type. In other words, if you are passing an integer or a numeric variable into a function or context that is expecting a string, R will happily convert the numeric variable to a string. Hence you can do:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Pi is"</span>, <span class="fl">3.1415</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pi is 3.1415"</code></pre>
</div>
</div>
<p>In the above, <code>3.1415</code> is a numeric variable, but R is content to convert it to a string to <code>paste()</code> it to the string “Pi is”.</p>
<p>Python does not automatically convert types to the more general type. As we saw above, to concatenate two strings in python we can use the <code>+</code> operator:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">'string1'</span> <span class="op">+</span> <span class="st">'string2'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>'string1string2'</code></pre>
</div>
</div>
<p>However python won’t automatically convert an numeric type, say, to a character type to get this job done. In other words, if we do this in python:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="st">"Pi is "</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fl">3.1415</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>TypeError: can only concatenate str (not "float") to str</code></pre>
</div>
</div>
<p>We get an error, rather than getting “Pi is 3.1415”.</p>
<p>Therefore, when mixing types in an operation, but desiring a particular type as the output, you may need to <em>coerce</em> variables to that output type. For example:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">+</span> <span class="bu">str</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>'Pi is 3.1415'</code></pre>
</div>
</div>
<p>The five data types in python that correspond to R’s five, main, atomic data types are given in the following tables, along with the functions used for coercion to that data type.</p>
<div id="tbl-panel" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-panel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12.1: Five atomic data types in R and Python
</figcaption>
<div aria-describedby="tbl-panel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-panel" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-first" class="quarto-float anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-first-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) R Types
</figcaption>
<div aria-describedby="tbl-first-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: left;">coercion</th>
<th style="text-align: left;">examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">logical</td>
<td style="text-align: left;"><code>as.logical()</code></td>
<td style="text-align: left;"><code>TRUE</code>, <code>FALSE</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">integer</td>
<td style="text-align: left;"><code>as.integer()</code></td>
<td style="text-align: left;"><code>3L</code>, <code>16L</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;"><code>as.numeric()</code></td>
<td style="text-align: left;"><code>3</code>, <code>16</code>, <code>4.2</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">complex</td>
<td style="text-align: left;"><code>as.complex()</code></td>
<td style="text-align: left;"><code>3.2 + 4i</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">character</td>
<td style="text-align: left;"><code>as.character()</code></td>
<td style="text-align: left;"><code>"foo"</code>, <code>'bar'</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-panel" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-second" class="quarto-float anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-second-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Python Types
</figcaption>
<div aria-describedby="tbl-second-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: left;">coercion</th>
<th style="text-align: left;">examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bool</td>
<td style="text-align: left;"><code>bool()</code></td>
<td style="text-align: left;"><code>True</code>, <code>False</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">int</td>
<td style="text-align: left;"><code>int()</code></td>
<td style="text-align: left;"><code>3</code>, <code>16</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">float</td>
<td style="text-align: left;"><code>float()</code></td>
<td style="text-align: left;"><code>3.0</code>, <code>16.0</code>, <code>4.2</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">complex</td>
<td style="text-align: left;"><code>complex()</code></td>
<td style="text-align: left;"><code>3 + 4j</code>, <code>8.2 + 2.3j</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">str</td>
<td style="text-align: left;"><code>str()</code></td>
<td style="text-align: left;"><code>"foo"</code>, <code>'bar'</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<p>We emphasize a few important points here:</p>
<ol type="1">
<li>Python uses <code>True</code> and <code>False</code> for its Boolean types, while R uses <code>TRUE</code> and <code>FALSE</code>. The capitalization differences are very important. The variations don’t work across languages!</li>
<li>While R has the <code>class()</code> function to tell you what class any object is, python has the <code>type()</code> function that tells you what data type an object is. This can be quite useful for familiarizing yourself with what is going on in your own code, or someone else’s:</li>
</ol>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>list2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">FALSE</span>, <span class="dv">3</span>L, <span class="fl">3.1415</span>, <span class="dv">3</span> <span class="sc">+</span> <span class="fl">4.2</span>i, <span class="st">"Boing!"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(list2, class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "logical"

[[2]]
[1] "integer"

[[3]]
[1] "numeric"

[[4]]
[1] "complex"

[[5]]
[1] "character"</code></pre>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>list2 <span class="op">=</span> [<span class="va">False</span>, <span class="dv">3</span>, <span class="fl">3.1415</span>, <span class="dv">3</span> <span class="op">+</span> <span class="ot">4.2j</span>, <span class="st">"Boing!"</span>]</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">type</span>, list2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[&lt;class 'bool'&gt;, &lt;class 'int'&gt;, &lt;class 'float'&gt;, &lt;class 'complex'&gt;, &lt;class 'str'&gt;]</code></pre>
</div>
</div>
<ol start="3" type="1">
<li><code>list</code> is itself a data type in python, and when we write <code>list(map(type, list2))</code> we are essentially coercing an object of class <code>map</code> to be a list.</li>
</ol>
</section>
<section id="list-comprehension-operating-on-every-element-of-a-list-part-2" class="level3" data-number="12.2.7">
<h3 data-number="12.2.7" class="anchored" data-anchor-id="list-comprehension-operating-on-every-element-of-a-list-part-2"><span class="header-section-number">12.2.7</span> List comprehension: Operating on every element of a list, Part 2</h3>
<p>Previously, we saw the R <code>lapply()</code> command. We note here that you could have applied a function to every element of a list in R using a <code>for</code> loop. We could have done something like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>L_R2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(L_R)) L_R2[[i]] <span class="ot">&lt;-</span> <span class="fu">paste</span>(L_R[[i]], <span class="st">"Weird!"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># now print it out:</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>L_R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "1 Weird!"

[[2]]
[1] "2 Weird!"

[[3]]
[1] "R Weird!"

[[4]]
[1] "word Weird!"

[[5]]
[1] "New Last Element Weird!"</code></pre>
</div>
</div>
<p>The above is not considered good R style, it is not much fun to look at and it will operate more slowly than <code>lapply()</code> in most circumstances. However, it is good to see this to motivate an approach in python for operating on every element of a list (and returning a list) that <em>is</em> considered good python style. This is called the syntax of “list comprehension”, and it looks like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python, but not meant to be run:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">"do something to x"</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">list</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>where “do something to x” is replaced by some operation on a variable called <code>x</code> (or whatever you might want to call it) and list is an existing list object.</p>
<p>So, to paste “Weird!” onto the elements of the list <code>L_Py</code> via list comprehension we would do:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>[<span class="bu">str</span>(x) <span class="op">+</span> <span class="st">" Weird!"</span> <span class="cf">for</span> x <span class="kw">in</span> L_Py]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['1 Weird!', '2 Weird!', 'R Weird!', 'word Weird!', 'New Last Element Weird!']</code></pre>
</div>
</div>
<p>See that it returns a list. Unlike in R, for loops, and especially those within a list comprehension, are not eschewed.</p>
<p>There is actually a further subtlety here. The <code>for</code> in there can cycle over the elements in a list, but in fact, it is much more general. It can cycle over all the elements in any “iterable” (i.e., able to be iterated over), object. For example a single string like <code>"ABCDEFG"</code> is iterable—python will iterate over the different letters in the string. Thus you could make a list of the letters in a string like:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>[x <span class="cf">for</span> x <span class="kw">in</span> <span class="st">"ABCDEFG"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['A', 'B', 'C', 'D', 'E', 'F', 'G']</code></pre>
</div>
</div>
<p>In fact, you can go for even more economy and note that <code>list()</code> in python applied to any iterable object, will automatically iterate over the iterable elements in the object. Hence, this does the same as the previous line:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(<span class="st">"ABCDEFG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['A', 'B', 'C', 'D', 'E', 'F', 'G']</code></pre>
</div>
</div>
<p>That is good to keep in mind. If you want a list of length 1 that includes the string <code>"ABCDDEFG"</code>, then, rather that <code>list("ABCDEFG")</code>, you would want to do:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>[<span class="st">"ABCDEFG"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['ABCDEFG']</code></pre>
</div>
</div>
</section>
<section id="for-lists-in-python-is-like-cit-catenates-the-lists" class="level3" data-number="12.2.8">
<h3 data-number="12.2.8" class="anchored" data-anchor-id="for-lists-in-python-is-like-cit-catenates-the-lists"><span class="header-section-number">12.2.8</span> For lists, <code>+</code> in python is like <code>c()</code>—it catenates the lists</h3>
<p>In R, if you want to add one list onto the end of another, essentially catenating them, you would use <code>c()</code> like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(L_R, <span class="fu">list</span>(<span class="st">"add"</span>, <span class="st">"some"</span>, <span class="st">"more"</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1

[[2]]
[1] 2

[[3]]
[1] "R"

[[4]]
[1] "word"

[[5]]
[1] "New Last Element"

[[6]]
[1] "add"

[[7]]
[1] "some"

[[8]]
[1] "more"

[[9]]
[1] 3</code></pre>
</div>
</div>
<p>In python, you use <code>+</code> for that type of operation:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>L_Py <span class="op">+</span> [<span class="st">"add"</span>, <span class="st">"some"</span>, <span class="st">"more"</span>, <span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 'R', 'word', 'New Last Element', 'add', 'some', 'more', 3]</code></pre>
</div>
</div>
</section>
<section id="sec-dict" class="level3" data-number="12.2.9">
<h3 data-number="12.2.9" class="anchored" data-anchor-id="sec-dict"><span class="header-section-number">12.2.9</span> Named lists in R and <code>dict</code>s in python</h3>
<p>In R, the separate elements of a list can be <em>named</em> and we can use the names to access them. For exmaple:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>dinners <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Monday =</span> <span class="st">"Arctic char"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tuesday =</span> <span class="st">"Chicken soup"</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wednesday =</span> <span class="st">"Pizza"</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Thursday =</span> <span class="st">"Stir fry"</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Friday=</span> <span class="st">"Fend for yourselves, kids!"</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>And then we can access each element of the list by its name in two ways:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># either with the dollar sign</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>dinners<span class="sc">$</span>Tuesday</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chicken soup"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or with double brackets</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>dinners[[<span class="st">"Friday"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Fend for yourselves, kids!"</code></pre>
</div>
</div>
<p>And of course we can assign values to that list in either way:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make the changes</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>dinners<span class="sc">$</span>Friday <span class="ot">&lt;-</span> <span class="st">"Go out to brewery"</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>dinners[[<span class="st">"Tuesday"</span>]] <span class="ot">&lt;-</span> <span class="st">"Burritos"</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># then see what that did:</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>dinners</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$Monday
[1] "Arctic char"

$Tuesday
[1] "Burritos"

$Wednesday
[1] "Pizza"

$Thursday
[1] "Stir fry"

$Friday
[1] "Go out to brewery"</code></pre>
</div>
</div>
<p>Interestingly, the elements of a named list in R can still be accessed by their index. We could get “Pizza” out of the <code>dinners</code> list in three different ways:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>dinners<span class="sc">$</span>Wednesday</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pizza"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>dinners[[<span class="st">"Wednesday"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pizza"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>dinners[[<span class="dv">3</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pizza"</code></pre>
</div>
</div>
<p>Lists in python do not take names like lists in R; however, there is another data type in python that does behave something like a named list. This data type is called a <strong>dict</strong>, which is, I believe, short for “dictionary.” We can make a <code>dict</code> of our dinners like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>dinners <span class="op">=</span> {</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Monday"</span>: <span class="st">"Arctic char"</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tuesday"</span>: <span class="st">"Chicken soup"</span>,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Wednesday"</span>: <span class="st">"Pizza"</span>,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Thursday"</span>:  <span class="st">"Stir fry"</span>,</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Friday"</span>: <span class="st">"Fend for yourselves, kids!"</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>And we can print it like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>dinners</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>{'Monday': 'Arctic char', 'Tuesday': 'Chicken soup', 'Wednesday': 'Pizza', 'Thursday': 'Stir fry', 'Friday': 'Fend for yourselves, kids!'}</code></pre>
</div>
</div>
<p>which is not much fun to look at, and gets really ugly when the dict has multiple nested levels (which is definitely possible, and we will see examples of that when we start playing with Snakemake config files).</p>
<p>As a side note, there is a python module called <code>pprint</code> that will pretty-print a variety of python objects. It can be used like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import only needs to happen once per session</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pprint</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>pprint.pp(dinners)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>{'Monday': 'Arctic char',
 'Tuesday': 'Chicken soup',
 'Wednesday': 'Pizza',
 'Thursday': 'Stir fry',
 'Friday': 'Fend for yourselves, kids!'}</code></pre>
</div>
</div>
<p>That is way more palatable!</p>
<p>Elements of a dictionary can be accessed much like elements of a named list in R, but python uses <code>[ ]</code> for that (rather than <code>$</code> or <code>[[ ]]</code>) like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>dinners[<span class="st">"Thursday"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>'Stir fry'</code></pre>
</div>
</div>
<p>In R, lists can be nested with multiple levels, and the same is true with <code>dicts</code> in python. (In fact, it is true with python lists, as well…)</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>meals <span class="op">=</span> {</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Monday"</span>: {<span class="st">"breakfast"</span>: <span class="st">"eggs"</span>, <span class="st">"lunch"</span>: <span class="st">"salad"</span>, <span class="st">"dinner"</span>: <span class="st">"Arctic char"</span>},</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tuesday"</span>: {<span class="st">"breakfast"</span>: <span class="st">"oatmeal"</span>, <span class="st">"lunch"</span>: <span class="st">"sandwich"</span>, <span class="st">"dinner"</span>: <span class="st">"Chicken soup"</span>}</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Now, each element at the top level (Monday or Tuesday) is itself a <code>dict</code> with three elements (breakfast, lunch, and dinner). If you want to get the value for Tuesday’s lunch, you just drill down into the dict, much like you would in a named R list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>meals[<span class="st">"Tuesday"</span>][<span class="st">"lunch"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'sandwich'</code></pre>
</div>
</div>
<p>We will come back to the <code>dict</code> data struture a lot when we talk about how Snakemake parses and stores the information in YAML formatted snakemake <em>config</em> files.</p>
</section>
<section id="classes-and-objects" class="level3" data-number="12.2.10">
<h3 data-number="12.2.10" class="anchored" data-anchor-id="classes-and-objects"><span class="header-section-number">12.2.10</span> Classes and objects</h3>
<p>R has a system called S4 that allows for very general kinds of objects to be defined. Most people don’t fiddle with that too much, so it isn’t much help by analogy. Python also has a mechanism to define certain <em>classes</em> of objects that can be very general. The programmer can define a class of objects, and then create an object which is an instance of a class. For our purposes working with snakemake, the important part is that instances of a class can hold <em>attributes</em> that can be just about anything.</p>
<p>We are discussing this because Snakemake, when it is executing, carries around values of wildcards in these sorts of objects, and you can access the wildcard values as attributes of a <code>wildcards</code> object (e.g.&nbsp;you can get their values using <code>wildcards.sample</code> or <code>wildcards.chromo</code>) and use those values in what are called <em>input functions</em> which we will see in the next chapter.</p>
<p>Here we just present a simple example of defining a class, creating an object that is an instance of that class, and then setting and accessing attribute values in it.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define class. Can be named anything. We name this Foo.</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pass is just a placeholder.  There could/should be some code there</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># but our silly example class, here, does nothing, so we just give</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># it "pass" which is code that does nothing</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo(<span class="bu">object</span>):</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">pass</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create an instance of class Foo called myfoo</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>myfoo <span class="op">=</span> Foo()</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co"># assign some values to some attributes. Uses the . (dot)</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>myfoo.attrib1 <span class="op">=</span> <span class="st">"bing"</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>myfoo.attrib2 <span class="op">=</span> <span class="st">"bong"</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>myfoo.hello <span class="op">=</span> [<span class="st">"bonjour"</span>, <span class="st">"hola"</span>, <span class="st">"hallo"</span>]</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co"># access the value of those attributes</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>myfoo.attrib1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>'bing'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>myfoo.attrib2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'bong'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>myfoo.hello</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['bonjour', 'hola', 'hallo']</code></pre>
</div>
</div>
<p>So, we just wanted people to see this because it turns out it is helpful when writing snakemake <em>input functions</em> to be able to create a fake <code>wildcards</code> object for testing those input functions.</p>
</section>
<section id="defining-functions" class="level3" data-number="12.2.11">
<h3 data-number="12.2.11" class="anchored" data-anchor-id="defining-functions"><span class="header-section-number">12.2.11</span> Defining functions</h3>
<p>Here we will compare and contrast how functions are defined in R and python, and in the process we will see how blocks of code in python are defined by indentation, rather than by, say, curly braces, as in R.</p>
<p>If you are familiar with R functions, then you know you can define one like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>add2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>That is a function that adds 2 to its argument. Like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">add2</span>(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<p>Not very exciting, but we see that the code of the function is enclosed in curly braces, and, in R, the value produced by the last line of code gets returned by the function.</p>
<p>In python, the equivalent function would be defined this way:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add2(x):</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x <span class="op">+</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>And you can use it like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>add2(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>8</code></pre>
</div>
</div>
<p>Instead of putting the code between curly braces, python uses <em>indentation</em> to know which code belongs to the function. Any lines indented to the same degree (here, two spaces) after the colon on the first line are understood to be part of the function definition. Importantly, unlike R, python does not automatically return the value produced by the last line of code in the function. If you want your python function to return a value, you must prepend the value or object that you want returned with the keyword <code>return</code></p>
<p>We might also point out here that anywhere you might typically use curly braces in R to denote a block of code, python accomplishes the same thing with a colon and indentation—for loops, if and else statements, etc.</p>
<p>The parameters of a python function can be any valid python objects and you can have multiple parameters and they can have default values, if desired. For example</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here is a function that adds text ("Fun!", by default) to the elements of a list</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and returns a new list:</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fun(list_of_things, text<span class="op">=</span><span class="st">"Fun!"</span>):</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [ x <span class="op">+</span> <span class="st">", "</span> <span class="op">+</span> text <span class="cf">for</span> x <span class="kw">in</span> list_of_things]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>If we call it with no value for the <code>text</code> parameter we get the default value for <code>text</code>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>fun(list_of_things <span class="op">=</span> [<span class="st">"dogs"</span>, <span class="st">"kittens"</span>, <span class="st">"frisbees"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['dogs, Fun!', 'kittens, Fun!', 'frisbees, Fun!']</code></pre>
</div>
</div>
<p>But we could add the text argument to change it:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>fun(list_of_things <span class="op">=</span> [<span class="st">"snakes"</span>, <span class="st">"lizards"</span>, <span class="st">"squid"</span>], text <span class="op">=</span> <span class="st">"Slithery!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['snakes, Slithery!', 'lizards, Slithery!', 'squid, Slithery!']</code></pre>
</div>
</div>
</section>
<section id="r-packages-and-python-modules" class="level3" data-number="12.2.12">
<h3 data-number="12.2.12" class="anchored" data-anchor-id="r-packages-and-python-modules"><span class="header-section-number">12.2.12</span> R packages and python modules</h3>
<p>In R, when you want to include a bunch of useful functions from an R package, you can use the library command:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>In python, you can do something similar by <em>importing</em> “modules.” We have already seen that with the <code>pprint</code> module for pretty printing things—we used:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pprint</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>That statement imports a <code>pprint</code> object, and once that is done we can use <em>all</em> the functions from the <code>pprint</code> module by naming them as attributes of the <code>pprint</code> object:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>pprint.pp(meals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>{'Monday': {'breakfast': 'eggs', 'lunch': 'salad', 'dinner': 'Arctic char'},
 'Tuesday': {'breakfast': 'oatmeal',
             'lunch': 'sandwich',
             'dinner': 'Chicken soup'}}</code></pre>
</div>
</div>
<p>In python, we can also be more fine-grained about what we import from different modules. At its most fine-grainedness, we could import just a single function from a module so that we can call that function by name, without calling it as an attribute of an object. For example, if we wanted to play with the <code>multiext</code> function from snakemake (which happens to reside in a module named <code>snakemake.io</code>) we can import it like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> snakemake.io <span class="im">import</span> multiext</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Now we can use the multiext function to see how it works:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>multiext(<span class="st">"path/dir/file"</span>, <span class="st">".pdf"</span>, <span class="st">".jpg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['path/dir/file.pdf', 'path/dir/file.jpg']</code></pre>
</div>
</div>
<p>Note that this works because we are using python in the conda environment that includes <code>snakemake</code>. (Remember the line like <code>use_condaenv(condaenv = "/projects/eriq@colostate.edu/miniforge3/envs/snakemake-8.5.3")</code>?) Otherwise, python typically would not find the snakemake module.</p>
<p>One can also import a module, but give its namespace a shorter name. For example, to prepare for the next section, we will import the ‘pandas’ module, but we will name it <code>pd</code> for brevity.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="tabular-data-pandas-in-python-is-sort-of-like-dplyr-in-r" class="level3" data-number="12.2.13">
<h3 data-number="12.2.13" class="anchored" data-anchor-id="tabular-data-pandas-in-python-is-sort-of-like-dplyr-in-r"><span class="header-section-number">12.2.13</span> Tabular data: pandas in python is sort of like dplyr in R</h3>
<p>Most R users are now familiar with the ‘tidyverse’ and its packages like ‘readr’ and ‘dplyr’. We give an example here, reading a small tab-separated file with information about the samples in our example Chinook salmon data set, which is in the repo at: <code>data/config/units.tsv</code>. The easiest way to peruse it is to view it on GitHub <a href="https://github.com/eriqande/con-gen-csu/blob/main/data/config/units.tsv">here</a>.</p>
<p>If we wanted to read it into R using the tidyverse, that would be pretty familiar (at least if we are tidyverse aficionados):</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">"./data/config/units.tsv"</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="co"># and then we print it to see the familiar tibble format</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>units</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 12
   sample     unit library flowcell platform  lane sample_id barcode fq1   fq2  
   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;
 1 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
 2 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
 3 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
 4 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
 5 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
 6 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
 7 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
 8 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
 9 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
10 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
11 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
12 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
13 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
14 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
15 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
16 DPCh_pla…     1 plate1  HTYYCBB… ILLUMINA     1 DPCh_pla… DPCh_p… data… data…
# ℹ 2 more variables: kb1 &lt;dbl&gt;, kb2 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>The python world has a similar package, called pandas. We imported it above, using <code>import pandas as pd</code>, so now we can use it to do a comparable read operation on our tab-separated file using the pandas function <code>read_table()</code>. We will also force each column to be stored as a string, too (which is often helpful if we are going to use these values in snakemake later…) Pandas also offers indexing of data frame for faster access, so, in this case we will index each row by the sample name</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>units <span class="op">=</span> pd.read_table(<span class="st">"./data/config/units.tsv"</span>, dtype<span class="op">=</span><span class="bu">str</span>).set_index(</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sample"</span>, drop<span class="op">=</span><span class="va">False</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co"># and then we can print it out:</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>units</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  sample unit  ...        kb1        kb2
sample                                         ...                      
DPCh_plate1_B10_S22  DPCh_plate1_B10_S22    1  ...  10822.571  12438.261
DPCh_plate1_B11_S23  DPCh_plate1_B11_S23    1  ...  10838.002  12026.601
DPCh_plate1_B12_S24  DPCh_plate1_B12_S24    1  ...  11437.975  12892.735
DPCh_plate1_C10_S34  DPCh_plate1_C10_S34    1  ...   14139.54  15767.478
DPCh_plate1_C11_S35  DPCh_plate1_C11_S35    1  ...   9705.477   11108.45
DPCh_plate1_C12_S36  DPCh_plate1_C12_S36    1  ...  10467.881  12064.275
DPCh_plate1_D09_S45  DPCh_plate1_D09_S45    1  ...  12167.214  13628.883
DPCh_plate1_D11_S47  DPCh_plate1_D11_S47    1  ...  12337.821  13929.613
DPCh_plate1_F10_S70  DPCh_plate1_F10_S70    1  ...  10805.055  11871.849
DPCh_plate1_F11_S71  DPCh_plate1_F11_S71    1  ...  12583.866  14308.931
DPCh_plate1_F12_S72  DPCh_plate1_F12_S72    1  ...   14848.51  16313.417
DPCh_plate1_G09_S81  DPCh_plate1_G09_S81    1  ...  20816.204  22987.841
DPCh_plate1_G10_S82  DPCh_plate1_G10_S82    1  ...  24775.084  27340.307
DPCh_plate1_G12_S84  DPCh_plate1_G12_S84    1  ...  18082.229  20757.831
DPCh_plate1_H09_S93  DPCh_plate1_H09_S93    1  ...   9702.925  10835.209
DPCh_plate1_H10_S94  DPCh_plate1_H10_S94    1  ...  11179.913  12277.416

[16 rows x 12 columns]</code></pre>
</div>
</div>
<p>That looks pretty similar. The first column in that output shows that <code>sample</code> is the index column (which we set with <code>.set_index()</code>, after reading it) of this pandas data frame.</p>
<p>Now, in R, if we wanted to pull out the values in some of the columns that correspond to a particular sample, we could do like this:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get fq1 value for DPCh_plate1_C12_S36</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>units <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"DPCh_plate1_C12_S36"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(fq1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data/fastqs/DPCh_plate1_C12_S36_R1.fq.gz"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get kb2 value for DPCh_plate1_C12_S36</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>units <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">==</span> <span class="st">"DPCh_plate1_C12_S36"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(kb2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12064.27</code></pre>
</div>
</div>
<p>In pandas you can do a similar thing with the <code>.loc</code> method (short for “location”) of <code>units</code>, leveraging the fact that we are using sample as the index. The syntax is:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>data_frame.loc( value of index,  Column )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>So, analagous to the above we could do, in python:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get fq1 value for DPCh_plate1_C12_S36</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>units.loc[ <span class="st">"DPCh_plate1_C12_S36"</span>, <span class="st">"fq1"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>'data/fastqs/DPCh_plate1_C12_S36_R1.fq.gz'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get kb2 value for DPCh_plate1_C12_S36</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>units.loc[ <span class="st">"DPCh_plate1_C12_S36"</span>, <span class="st">"kb2"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'12064.275'</code></pre>
</div>
</div>
<p>Note that if you want to extract values based on multiple values (both the samples and unit column, for example) you could do</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>units2 <span class="op">=</span> units.set_index([<span class="st">"sample"</span>, <span class="st">"unit"</span>], drop <span class="op">=</span> <span class="va">False</span>) </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>units2.loc[ (<span class="st">"DPCh_plate1_C12_S36"</span>, <span class="st">"1"</span>), <span class="st">"kb2"</span> ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>'12064.275'</code></pre>
</div>
</div>
<p>These are handy ways of populating parameters of rules with values that are taken from tabular data, for example, getting read group information for different samples.</p>
<p>We should point out that we can also use the <code>.loc</code> method to test more general conditions in the pandas data frame. For example, if we wanted a list of all the samples which have an F in their name we could put that condition test into place where the index went before:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>units.loc[ units[<span class="st">"sample"</span>].<span class="bu">str</span>.contains(<span class="st">"F"</span>), <span class="st">"sample"</span> ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>sample
DPCh_plate1_F10_S70    DPCh_plate1_F10_S70
DPCh_plate1_F11_S71    DPCh_plate1_F11_S71
DPCh_plate1_F12_S72    DPCh_plate1_F12_S72
Name: sample, dtype: object</code></pre>
</div>
</div>
<p>We see that this sort of construct returns the sample column in the correct rows, but it is still a pandas object. If we want to just get a list of those sample names, we use <code>.tolist()</code> on the end:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>python:</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>units.loc[ units[<span class="st">"sample"</span>].<span class="bu">str</span>.contains(<span class="st">"F"</span>), <span class="st">"sample"</span> ].tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>['DPCh_plate1_F10_S70', 'DPCh_plate1_F11_S71', 'DPCh_plate1_F12_S72']</code></pre>
</div>
</div>
<p>Those things come in handy when writing more complex workflows.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../nmfs-bioinf/snake.html" class="pagination-link" aria-label="Snakemake Narrative and Topics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Snakemake Narrative and Topics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../nmfs-bioinf/snakemake-embellishments.html" class="pagination-link" aria-label="Important Snakemake Embellishments">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Important Snakemake Embellishments</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/eriqande/con-gen-csu/edit/main/nmfs-bioinf/snakemake-relevant-python.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/eriqande/con-gen-csu/issues/new/choose" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>